<html>
  <head>
    <title>AR.js Basic Projected Camera Example</title>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <!-- Look-at component. We don't need this now, but we will later. -->
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
  </head>
  <body>
    <audio src="./assets/Sounds/theme_song.mp3" volume="0.01" autoplay></audio>
    <audio id="clickSound" src="./assets/Sounds/click_sound.mp3"></audio>

    <!-- Location Based Start  -->

    <!-- Location Based End  -->

    <!-- Position Based Start -->
    <a-scene
      xrweb="
    allowedDevices: any;"
    >
      <a-assets>
        <a-asset-item id="burgerModel" src="./assets/burger.glb"></a-asset-item>
        <a-asset-item
          id="panModel"
          src="./assets/pan_model/scene.gltf"
        ></a-asset-item>
        <a-asset-item
          id="tpaperModel"
          src="./assets/toiletPaper_model/glTF/scene.gltf"
        ></a-asset-item>
      </a-assets>

      <a-camera>
        <a-entity
          cursor="fuse: false; rayOrigin: mouse;"
          position="0 0 -1"
          color="red"
          raycaster="objects: .rune"
          geometry="primitive: ring; radiusInner: 0.02;
radiusOuter: 0.03"
          material="color: black; shader: flat"
        >
        </a-entity>
      </a-camera>

      <a-entity
        gltf-model="#burgerModel"
        id="box-red"
        class="rune"
        position="-10 4 -20"
        scale="3 3 3"
      ></a-entity>
      <a-entity
        id="box-yellow"
        gltf-model="#panModel"
        class="rune"
        position="-20 0.5 20"
        scale="50 30 50"
      ></a-entity>
      <a-entity
        id="box-blue"
        gltf-model="#tpaperModel"
        class="rune"
        position="-50 0.5 -20"
        scale="50 30 50"
      ></a-entity>
    </a-scene>
    <!-- Position Based End -->

    <script>
      const scene = document.querySelector("a-scene");
      const position = { x: 20, y: 0, z: -20 };
      let boxes;
      let color = "red";
      let scale = "10 10 10";
      const clickSound = document.querySelector("#clickSound");
      window.onload = () => {
        for (let i = 0; i < 2; i++) {
          generateElement(scene, position, color, scale);
          position.x *= i + 20;
          position.y *= i + 20;
          color = "yellow";
          scale = "15 15 15";
        }
        boxes = document.querySelectorAll(".rune");
        onSpawn();
        function onSpawn() {
          boxes.forEach((element) => {
            element.addEventListener("click", (e) => {
              element.setAttribute("animation", {
                property: "scale",
                to: "0 0 0",
                easing: "easeOutElastic",
                dur: 1000,
              });
              clickSound.play();
              setTimeout(() => {
                scene.removeChild(element);
              }, 1000);
              position.x = 30;
              position.y = Math.random() * 20 - 20;
              position.z = 30;
              scale = "2 2 2";
              console.log(position);
              generateElement(scene, position, color, scale);
              boxes = document.querySelectorAll(".rune");
              onSpawn();
            });
          });
        }
      };

      function generateElement(_scene, position, color, scale) {
        const newBox = document.createElement("a-box");
        newBox.setAttribute("class", "rune");
        newBox.setAttribute("position", position);
        newBox.setAttribute("scale", scale);
        newBox.setAttribute("color", color);
        _scene.appendChild(newBox);
      }
    </script>
  </body>
</html>
